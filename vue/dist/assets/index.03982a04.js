import{V as c,i as d,p as h,n as g}from"./index.46025505.js";import{T as p}from"./index.3aedcce4.js";import{R as f,C as _,a as m,b as C,c as y}from"./index.6b44d315.js";const i={host:"baidu.com",port:80,remote_host:"baidu2.com",remote_port:80,ssl:"0",remote_system:"\u5B9D\u5854",remote_app:"API\u4E1A\u52A1\u7CFB\u7EDF",guard_status:"",remarks:""};var T=c.extend({name:"ListBase",components:{SearchIcon:d,Trend:p},data(){return{addFormVisible:!1,editFormVisible:!1,formData:{...i},formEditData:{...i},rules:{host:[{required:!0,message:"\u8BF7\u8F93\u5165\u7F51\u7AD9\u540D\u79F0",type:"error"}]},textareaValue:"",remote_system_options:[{label:"\u5B9D\u5854",value:"1"},{label:"\u5C0F\u76AE\u9762\u677F(phpstudy)",value:"2"},{label:"PHPnow",value:"3"}],remote_app_options:[{label:"\u7EAF\u7F51\u7AD9",value:"1"},{label:"API\u4E1A\u52A1\u7CFB\u7EDF",value:"2"},{label:"\u4E1A\u52A1\u52A0\u7BA1\u7406",value:"3"}],RULE_STATUS:f,CONTRACT_STATUS:_,CONTRACT_STATUS_OPTIONS:m,CONTRACT_TYPES:C,CONTRACT_PAYMENT_TYPES:y,prefix:h,dataLoading:!1,data:[],detail_data:[],selectedRowKeys:[],value:"first",columns:[{colKey:"row-select",type:"multiple",width:64,fixed:"left"},{title:"\u89C4\u5219\u540D",align:"left",width:250,ellipsis:!0,colKey:"rule_name",fixed:"left"},{title:"\u89C4\u5219\u7248\u672C",colKey:"rule_version",width:200,cell:{col:"version"}},{title:"\u89C4\u5219\u72B6\u6001",colKey:"rule_status",width:200,cell:{col:"rule_status"}},{align:"left",fixed:"right",width:200,colKey:"op",title:"\u64CD\u4F5C"}],rowKey:"rule_code",tableLayout:"auto",verticalAlign:"top",hover:!0,rowClassName:e=>`${e}-class`,pagination:{total:0,current:1,pageSize:10},searchValue:"",confirmVisible:!1,deleteIdx:-1}},computed:{confirmBody(){var e;if(this.deleteIdx>-1){const{host:s}=(e=this.data)==null?void 0:e[this.deleteIdx];return`\u5220\u9664\u540E\uFF0C${s}\u7684\u6240\u6709\u7F51\u7AD9\u4FE1\u606F\u548C\u89C4\u5219\u5C06\u88AB\u6E05\u7A7A\uFF0C\u4E14\u65E0\u6CD5\u6062\u590D`}return""},offsetTop(){return this.$store.state.setting.isUseTabsRouter?48:0}},mounted(){this.getList("")},methods:{getList(e){let s=this;this.$request.get("/wafhost/rule/list",{params:{pageSize:s.pagination.pageSize,pageIndex:s.pagination.current}}).then(t=>{let a=t.data;console.log(a),a.code===200&&(this.data=a.data.list,this.pagination={...this.pagination,total:a.data.total})}).catch(t=>{console.log(t)}).finally(()=>{this.dataLoading=!1}),this.dataLoading=!0},getContainer(){return document.querySelector(".tdesign-starter-layout")},rehandlePageChange(e,s){console.log("\u5206\u9875\u53D8\u5316",e,s),this.pagination.current=e.current,this.pagination.pageSize!=e.pageSize&&(this.pagination.current=1,this.pagination.pageSize=e.pageSize),this.getList("")},rehandleSelectChange(e){this.selectedRowKeys=e},rehandleChange(e,s){console.log("\u7EDF\u4E00Change",e,s)},handleClickEdit(e){console.log(e);const{rule_code:s}=e.row;console.log(s),this.$router.push({path:"/waf-host/wafruleedit",query:{type:"edit",code:s}})},handleAddRule(){this.$router.push({path:"/waf-host/wafruleedit",query:{type:"add"}})},onSubmit({result:e,firstError:s}){let t=this;if(s)console.log("Errors: ",e),t.$message.warning(s);else{let a={...t.formData};a.ssl=Number(a.ssl),this.$request.post("/wafhost/host/add",{...a}).then(o=>{let l=o.data;console.log(l),l.code===200?(t.$message.success(l.msg),t.addFormVisible=!1,t.pagination.current=1,t.getList("")):t.$message.warning(l.msg)}).catch(o=>{console.log(o)}).finally(()=>{})}},onSubmitEdit({result:e,firstError:s}){let t=this;if(s)console.log("Errors: ",e),t.$message.warning(s);else{let a={...t.formEditData};a.ssl=Number(a.ssl),this.$request.post("/wafhost/host/edit",{...a}).then(o=>{let l=o.data;console.log(l),l.code===200?(t.$message.success(l.msg),t.editFormVisible=!1,t.pagination.current=1,t.getList("")):t.$message.warning(l.msg)}).catch(o=>{console.log(o)}).finally(()=>{})}},onClickCloseBtn(){this.formVisible=!1,this.formData={}},onClickCloseEditBtn(){this.editFormVisible=!1,this.formEditData={}},handleClickDelete(e){console.log(e),this.deleteIdx=e.rowIndex,this.confirmVisible=!0},onConfirmDelete(){this.confirmVisible=!1,console.log("delete",this.data),console.log("delete",this.data[this.deleteIdx]);let{code:e}=this.data[this.deleteIdx],s=this;this.$request.get("/wafhost/host/del",{params:{CODE:e}}).then(t=>{let a=t.data;console.log(a),a.code===200?(s.pagination.current=1,s.getList(""),s.$message.success(a.msg)):s.$message.warning(a.msg)}).catch(t=>{console.log(t)}).finally(()=>{}),this.resetIdx()},onCancel(){this.resetIdx()},resetIdx(){this.deleteIdx=-1},getDetail(e){let s=this;this.$request.get("/wafhost/host/detail",{params:{CODE:e}}).then(t=>{let a=t.data;console.log(a),a.code===200&&(s.detail_data=a.data,s.detail_data.ssl=s.detail_data.ssl.toString(),s.formEditData={...s.detail_data})}).catch(t=>{console.log(t)}).finally(()=>{})}}}),r=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",[t("t-card",{staticClass:"list-card-container"},[t("t-row",{attrs:{justify:"space-between"}},[t("div",{staticClass:"left-operation-container"},[t("t-button",{on:{click:e.handleAddRule}},[e._v(" \u65B0\u5EFA\u89C4\u5219 ")]),t("t-button",{attrs:{variant:"base",theme:"default",disabled:!e.selectedRowKeys.length}},[e._v(" \u5BFC\u51FA\u65E5\u5FD7 ")]),e.selectedRowKeys.length?t("p",{staticClass:"selected-count"},[e._v("\u5DF2\u9009"+e._s(e.selectedRowKeys.length)+"\u9879")]):e._e()],1),t("t-input",{staticClass:"search-input",attrs:{placeholder:"\u8BF7\u8F93\u5165\u4F60\u9700\u8981\u641C\u7D22\u7684\u89C4\u5219",clearable:""},scopedSlots:e._u([{key:"suffix-icon",fn:function(){return[t("search-icon",{attrs:{size:"20px"}})]},proxy:!0}]),model:{value:e.searchValue,callback:function(a){e.searchValue=a},expression:"searchValue"}})],1),t("div",{staticClass:"table-container"},[t("t-table",{attrs:{columns:e.columns,data:e.data,rowKey:e.rowKey,verticalAlign:e.verticalAlign,hover:e.hover,pagination:e.pagination,"selected-row-keys":e.selectedRowKeys,loading:e.dataLoading,headerAffixedTop:!0,headerAffixProps:{offsetTop:e.offsetTop,container:e.getContainer}},on:{"page-change":e.rehandlePageChange,change:e.rehandleChange,"select-change":e.rehandleSelectChange},scopedSlots:e._u([{key:"rule_status",fn:function(a){var o=a.row;return[o.rule_status===e.RULE_STATUS.STOPPING?t("t-tag",{attrs:{theme:"danger",variant:"light"}},[e._v("\u672A\u751F\u6548")]):e._e(),o.rule_status===e.RULE_STATUS.RUNNING?t("t-tag",{attrs:{theme:"success",variant:"light"}},[e._v("\u751F\u6548")]):e._e()]}},{key:"contractType",fn:function(a){var o=a.row;return[o.contractType===e.CONTRACT_TYPES.MAIN?t("p",[e._v("\u5BA1\u6838\u5931\u8D25")]):e._e(),o.contractType===e.CONTRACT_TYPES.SUB?t("p",[e._v("\u5F85\u5BA1\u6838")]):e._e(),o.contractType===e.CONTRACT_TYPES.SUPPLEMENT?t("p",[e._v("\u5F85\u5C65\u884C")]):e._e()]}},{key:"paymentType",fn:function(a){var o=a.row;return[o.paymentType===e.CONTRACT_PAYMENT_TYPES.PAYMENT?t("p",{staticClass:"payment-col"},[e._v(" \u4ED8\u6B3E "),t("trend",{staticClass:"dashboard-item-trend",attrs:{type:"up"}})],1):e._e(),o.paymentType===e.CONTRACT_PAYMENT_TYPES.RECIPT?t("p",{staticClass:"payment-col"},[e._v(" \u6536\u6B3E "),t("trend",{staticClass:"dashboard-item-trend",attrs:{type:"down"}})],1):e._e()]}},{key:"op",fn:function(a){return[t("a",{staticClass:"t-button-link",on:{click:function(o){return e.handleClickEdit(a)}}},[e._v("\u7F16\u8F91")]),t("a",{staticClass:"t-button-link",on:{click:function(o){return e.handleClickDelete(a)}}},[e._v("\u5220\u9664")])]}}])})],1)],1),t("t-dialog",{attrs:{header:"\u786E\u8BA4\u5220\u9664\u5F53\u524D\u6240\u9009\u89C4\u5219\u5417?",body:e.confirmBody,visible:e.confirmVisible,onCancel:e.onCancel},on:{"update:visible":function(a){e.confirmVisible=a},confirm:e.onConfirmDelete}})],1)},v=[];r._withStripped=!0;const n={};var u=g(T,r,v,!1,A,"1c1d3081",null,null);function A(e){for(let s in n)this[s]=n[s]}u.options.__file="src/pages/waf-host/rule/index.vue";var S=function(){return u.exports}();export{S as default};
