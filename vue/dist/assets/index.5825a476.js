import{V as m,i as f,p as h,n as p}from"./index.46025505.js";import{T as g}from"./index.3aedcce4.js";import{G as _,S as b,C as v,a as y,b as D,c as x}from"./index.6b44d315.js";const n={host:"baidu.com",port:80,remote_host:"baidu2.com",remote_port:80,ssl:"0",remote_system:"\u5B9D\u5854",remote_app:"API\u4E1A\u52A1\u7CFB\u7EDF",guard_status:"",remarks:""};var C=m.extend({name:"ListBase",components:{SearchIcon:f,Trend:g},data(){return{addFormVisible:!1,editFormVisible:!1,guardVisible:!1,confirmVisible:!1,formData:{...n},formEditData:{...n},rules:{host:[{required:!0,message:"\u8BF7\u8F93\u5165\u7F51\u7AD9\u540D\u79F0",type:"error"}]},textareaValue:"",remote_system_options:[{label:"\u5B9D\u5854",value:"1"},{label:"\u5C0F\u76AE\u9762\u677F(phpstudy)",value:"2"},{label:"PHPnow",value:"3"}],remote_app_options:[{label:"\u7EAF\u7F51\u7AD9",value:"1"},{label:"API\u4E1A\u52A1\u7CFB\u7EDF",value:"2"},{label:"\u4E1A\u52A1\u52A0\u7BA1\u7406",value:"3"}],GUARD_STATUS:_,SSL_STATUS:b,CONTRACT_STATUS:v,CONTRACT_STATUS_OPTIONS:y,CONTRACT_TYPES:D,CONTRACT_PAYMENT_TYPES:x,prefix:h,dataLoading:!1,data:[],detail_data:[],selectedRowKeys:[],value:"first",columns:[{colKey:"row-select",type:"multiple",width:64,fixed:"left"},{title:"\u7F51\u7AD9",align:"left",width:250,ellipsis:!0,colKey:"host",fixed:"left"},{title:"\u7F51\u7AD9\u7AEF\u53E3",width:200,ellipsis:!0,colKey:"port"},{title:"\u9632\u62A4\u72B6\u6001",colKey:"guard_status",width:200,cell:{col:"guard_status"}},{title:"\u52A0\u5BC6\u8BC1\u4E66",width:200,ellipsis:!0,colKey:"ssl",cell:{col:"ssl"}},{title:"\u5907\u6CE8",width:200,ellipsis:!0,colKey:"remarks"},{title:"\u6DFB\u52A0\u65F6\u95F4",width:200,ellipsis:!0,colKey:"create_time"},{align:"left",fixed:"right",width:200,colKey:"op",title:"\u64CD\u4F5C"}],rowKey:"code",tableLayout:"auto",verticalAlign:"top",hover:!0,rowClassName:t=>`${t}-class`,pagination:{total:0,current:1,pageSize:10},searchValue:"",deleteIdx:-1,guardStatusIdx:-1}},computed:{confirmBody(){var t;if(this.deleteIdx>-1){const{host:s}=(t=this.data)==null?void 0:t[this.deleteIdx];return`\u5220\u9664\u540E\uFF0C${s}\u7684\u6240\u6709\u7F51\u7AD9\u4FE1\u606F\u548C\u89C4\u5219\u5C06\u88AB\u6E05\u7A7A\uFF0C\u4E14\u65E0\u6CD5\u6062\u590D`}return""},offsetTop(){return this.$store.state.setting.isUseTabsRouter?48:0}},mounted(){this.getList("")},methods:{getList(t){let s=this;this.$request.get("/wafhost/host/list",{params:{pageSize:s.pagination.pageSize,pageIndex:s.pagination.current}}).then(e=>{let a=e.data;if(console.log(a),a.code===200){this.data=a.data.list,this.data_attach=[];for(var l=0;l<this.data.length;l++)this.data[l].guard_status_visiable=!1;console.log("getList",this.data),this.pagination={...this.pagination,total:a.data.total}}}).catch(e=>{console.log(e)}).finally(()=>{this.dataLoading=!1}),this.dataLoading=!0},getContainer(){return document.querySelector(".tdesign-starter-layout")},rehandlePageChange(t,s){console.log("\u5206\u9875\u53D8\u5316",t,s),this.pagination.current=t.current,this.pagination.pageSize!=t.pageSize&&(this.pagination.current=1,this.pagination.pageSize=t.pageSize),this.getList("")},rehandleSelectChange(t){this.selectedRowKeys=t},rehandleChange(t,s){console.log("\u7EDF\u4E00Change",t,s)},handleClickDetail(t){console.log(t);const{code:s}=t.row;console.log(s),this.$router.push({path:"/waf-host/wafhostdetail",query:{code:s}})},handleClickEdit(t){console.log(t);const{code:s}=t.row;console.log(s),this.editFormVisible=!0,this.getDetail(s)},handleAddHost(){this.addFormVisible=!0},onSubmit({result:t,firstError:s}){let e=this;if(s)console.log("Errors: ",t),e.$message.warning(s);else{let a={...e.formData};a.ssl=Number(a.ssl),this.$request.post("/wafhost/host/add",{...a}).then(l=>{let o=l.data;console.log(o),o.code===200?(e.$message.success(o.msg),e.addFormVisible=!1,e.pagination.current=1,e.getList("")):e.$message.warning(o.msg)}).catch(l=>{console.log(l)}).finally(()=>{})}},onSubmitEdit({result:t,firstError:s}){let e=this;if(s)console.log("Errors: ",t),e.$message.warning(s);else{let a={...e.formEditData};a.ssl=Number(a.ssl),this.$request.post("/wafhost/host/edit",{...a}).then(l=>{let o=l.data;console.log(o),o.code===200?(e.$message.success(o.msg),e.editFormVisible=!1,e.pagination.current=1,e.getList("")):e.$message.warning(o.msg)}).catch(l=>{console.log(l)}).finally(()=>{})}},onClickCloseBtn(){this.formVisible=!1,this.formData={}},onClickCloseEditBtn(){this.editFormVisible=!1,this.formEditData={}},handleClickDelete(t){console.log(t),this.deleteIdx=t.rowIndex,this.confirmVisible=!0},onConfirmDelete(){this.confirmVisible=!1,console.log("delete",this.data),console.log("delete",this.data[this.deleteIdx]);let{code:t}=this.data[this.deleteIdx],s=this;this.$request.get("/wafhost/host/del",{params:{CODE:t}}).then(e=>{let a=e.data;console.log(a),a.code===200?(s.pagination.current=1,s.getList(""),s.$message.success(a.msg)):s.$message.warning(a.msg)}).catch(e=>{console.log(e)}).finally(()=>{}),this.resetIdx()},onCancel(){this.resetIdx()},resetIdx(){this.deleteIdx=-1},getDetail(t){let s=this;this.$request.get("/wafhost/host/detail",{params:{CODE:t}}).then(e=>{let a=e.data;console.log(a),a.code===200&&(s.detail_data=a.data,s.detail_data.ssl=s.detail_data.ssl.toString(),s.formEditData={...s.detail_data})}).catch(e=>{console.log(e)}).finally(()=>{})},changeGuardStatus(t,s){console.log(t,s);let{code:e}=s,a=this.data.findIndex(function(l,o,r){return console.log("findIndex",l,o,r),l.code==e});console.log("rowIndex",a),this.data[a].guard_status_visiable=!this.data[a].guard_status_visiable,this.guardStatusIdx=a,console.log(t)},onVisibleChange(t,s={}){let e=this;if(console.log("this.guardStatusIdx",this.guardStatusIdx),this.guardStatusIdx==-1)return;console.log("this.data",this.data[e.guardStatusIdx]);let{code:a,guard_status:l}=this.data[this.guardStatusIdx];if(console.log(s,s.trigger),s&&s.trigger==="confirm"){console.log("guardStatusIdx",e.guardStatusIdx);const o=e.$message.info("\u63D0\u4EA4\u4E2D");e.$request.get("/wafhost/host/guardstatus",{params:{CODE:a,GUARD_STATUS:l==1?0:1}}).then(r=>{let i=r.data;console.log(i),i.code===200?(e.getList(""),e.$message.close(o),e.$message.success(i.msg),e.data[e.guardStatusIdx].guard_status_visiable=!1,e.guardStatusIdx=-1):e.$message.warning(i.msg)}).catch(r=>{console.log(r)}).finally(()=>{})}else s&&s.trigger==="cancel"&&(console.log("this.data",e.data),console.log("that.data[that.guardStatusIdx]",e.data[e.guardStatusIdx]),e.data[e.guardStatusIdx].guard_status_visiable=!1,e.guardStatusIdx=-1)}}}),u=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",[e("t-card",{staticClass:"list-card-container"},[e("t-row",{attrs:{justify:"space-between"}},[e("div",{staticClass:"left-operation-container"},[e("t-button",{on:{click:t.handleAddHost}},[t._v(" \u65B0\u5EFA\u9632\u62A4 ")]),e("t-button",{attrs:{variant:"base",theme:"default",disabled:!t.selectedRowKeys.length}},[t._v(" \u5BFC\u51FA\u65E5\u5FD7 ")]),t.selectedRowKeys.length?e("p",{staticClass:"selected-count"},[t._v("\u5DF2\u9009"+t._s(t.selectedRowKeys.length)+"\u9879")]):t._e()],1),e("t-input",{staticClass:"search-input",attrs:{placeholder:"\u8BF7\u8F93\u5165\u4F60\u9700\u8981\u641C\u7D22\u7684\u653B\u51FB\u65E5\u5FD7",clearable:""},scopedSlots:t._u([{key:"suffix-icon",fn:function(){return[e("search-icon",{attrs:{size:"20px"}})]},proxy:!0}]),model:{value:t.searchValue,callback:function(a){t.searchValue=a},expression:"searchValue"}})],1),e("div",{staticClass:"table-container"},[e("t-table",{attrs:{columns:t.columns,data:t.data,rowKey:t.rowKey,verticalAlign:t.verticalAlign,hover:t.hover,pagination:t.pagination,"selected-row-keys":t.selectedRowKeys,loading:t.dataLoading,headerAffixedTop:!0,headerAffixProps:{offsetTop:t.offsetTop,container:t.getContainer}},on:{"page-change":t.rehandlePageChange,change:t.rehandleChange,"select-change":t.rehandleSelectChange},scopedSlots:t._u([{key:"guard_status",fn:function(a){var l=a.row;return[e("t-popconfirm",{attrs:{theme:"default",visible:l.guard_status_visiable},on:{"visible-change":t.onVisibleChange}},[e("template",{slot:"content"},[e("p",{staticClass:"title"},[t._v("\u9632\u62A4\u89C4\u5219")]),e("p",{staticClass:"describe"},[t._v("\u5E26\u63CF\u8FF0\u7684\u6C14\u6CE1\u786E\u8BA4\u6846\u5728\u4E3B\u8981\u8BF4\u660E\u4E4B\u5916\u589E\u52A0\u4E86\u64CD\u4F5C\u76F8\u5173\u7684\u8BE6\u7EC6\u63CF\u8FF0")])]),e("t-switch",{attrs:{size:"large",label:["\u5DF2\u9632\u62A4","\u672A\u9632\u62A4"]},on:{change:function(o){return t.changeGuardStatus(o,l)}},model:{value:l.guard_status===1,callback:function(o){t.$set(l,"guard_status ===1",o)},expression:"row.guard_status ===1"}})],2)]}},{key:"ssl",fn:function(a){var l=a.row;return[l.ssl===t.SSL_STATUS.NOT_SSL?e("p",[t._v("\u5426")]):t._e(),l.ssl===t.SSL_STATUS.SSL?e("p",[t._v("\u662F")]):t._e()]}},{key:"paymentType",fn:function(a){var l=a.row;return[l.paymentType===t.CONTRACT_PAYMENT_TYPES.PAYMENT?e("p",{staticClass:"payment-col"},[t._v(" \u4ED8\u6B3E "),e("trend",{staticClass:"dashboard-item-trend",attrs:{type:"up"}})],1):t._e(),l.paymentType===t.CONTRACT_PAYMENT_TYPES.RECIPT?e("p",{staticClass:"payment-col"},[t._v(" \u6536\u6B3E "),e("trend",{staticClass:"dashboard-item-trend",attrs:{type:"down"}})],1):t._e()]}},{key:"op",fn:function(a){return[e("a",{staticClass:"t-button-link",on:{click:function(l){return t.handleClickDetail(a)}}},[t._v("\u8BE6\u60C5")]),e("a",{staticClass:"t-button-link",on:{click:function(l){return t.handleClickEdit(a)}}},[t._v("\u7F16\u8F91")]),e("a",{staticClass:"t-button-link",on:{click:function(l){return t.handleClickDelete(a)}}},[t._v("\u5220\u9664")])]}}])})],1)],1),e("t-dialog",{attrs:{header:"\u65B0\u5EFA\u7F51\u7AD9\u9632\u5FA1",visible:t.addFormVisible,width:680,footer:!1},on:{"update:visible":function(a){t.addFormVisible=a}}},[e("div",{attrs:{slot:"body"},slot:"body"},[e("t-form",{ref:"form",attrs:{data:t.formData,rules:t.rules,labelWidth:100},on:{submit:t.onSubmit}},[e("t-form-item",{attrs:{label:"\u7F51\u7AD9",name:"host"}},[e("t-input",{style:{width:"480px"},attrs:{placeholder:"\u8BF7\u8F93\u5165\u7F51\u7AD9\u7684\u7F51\u5740"},model:{value:t.formData.host,callback:function(a){t.$set(t.formData,"host",a)},expression:"formData.host"}})],1),e("t-form-item",{attrs:{label:"\u7AEF\u53E3",name:"port"}},[e("t-input-number",{style:{width:"150px"},attrs:{placeholder:"\u8BF7\u8F93\u5165\u7F51\u7AD9\u7684\u7AEF\u53E3\u4E00\u822C\u662F80/443"},model:{value:t.formData.port,callback:function(a){t.$set(t.formData,"port",a)},expression:"formData.port"}})],1),e("t-form-item",{attrs:{label:"\u52A0\u5BC6\u8BC1\u4E66",name:"ssl"}},[e("t-radio-group",{model:{value:t.formData.ssl,callback:function(a){t.$set(t.formData,"ssl",a)},expression:"formData.ssl"}},[e("t-radio",{attrs:{value:"0"}},[t._v("\u975E\u52A0\u5BC6")]),e("t-radio",{attrs:{value:"1"}},[t._v("\u52A0\u5BC6\u8BC1\u4E66\uFF08\u9700\u4E0A\u4F20\u8BC1\u4E66\uFF09")])],1)],1),t.formData.ssl=="1"?e("t-form-item",{attrs:{label:"\u8BC1\u4E66\u4E32",name:"certfile"}},[e("t-textarea",{style:{width:"480px"},attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9",name:"certfile"},model:{value:t.formData.certfile,callback:function(a){t.$set(t.formData,"certfile",a)},expression:"formData.certfile"}})],1):t._e(),t.formData.ssl=="1"?e("t-form-item",{attrs:{label:"\u5BC6\u94A5\u4E32",name:"keyfile"}},[e("t-textarea",{style:{width:"480px"},attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9",name:"keyfile"},model:{value:t.formData.keyfile,callback:function(a){t.$set(t.formData,"keyfile",a)},expression:"formData.keyfile"}})],1):t._e(),e("t-form-item",{attrs:{label:"\u540E\u7AEF\u7CFB\u7EDF\u7C7B\u578B",name:"remote_system"}},[e("t-select",{style:{width:"480px"},attrs:{clearable:""},model:{value:t.formData.remote_system,callback:function(a){t.$set(t.formData,"remote_system",a)},expression:"formData.remote_system"}},t._l(t.remote_system_options,function(a,l){return e("t-option",{key:l,attrs:{value:a.value,label:a.label}},[t._v(" "+t._s(a.label)+" ")])}),1)],1),e("t-form-item",{attrs:{label:"\u540E\u7AEF\u5E94\u7528\u7C7B\u578B",name:"remote_app"}},[e("t-select",{style:{width:"480px"},attrs:{clearable:""},model:{value:t.formData.remote_app,callback:function(a){t.$set(t.formData,"remote_app",a)},expression:"formData.remote_app"}},t._l(t.remote_app_options,function(a,l){return e("t-option",{key:l,attrs:{value:a.value,label:a.label}},[t._v(" "+t._s(a.label)+" ")])}),1)],1),e("t-form-item",{attrs:{label:"\u540E\u7AEF\u57DF\u540D",name:"remote_host"}},[e("t-input",{style:{width:"480px"},attrs:{placeholder:"\u8BF7\u8F93\u5165\u540E\u7AEF\u57DF\u540D"},model:{value:t.formData.remote_host,callback:function(a){t.$set(t.formData,"remote_host",a)},expression:"formData.remote_host"}})],1),e("t-form-item",{attrs:{label:"\u540E\u7AEF\u7AEF\u53E3",name:"remote_port"}},[e("t-input-number",{style:{width:"150px"},attrs:{placeholder:"\u8BF7\u8F93\u5165\u7F51\u7AD9\u7684\u7AEF\u53E3\u4E00\u822C\u662F80/443"},model:{value:t.formData.remote_port,callback:function(a){t.$set(t.formData,"remote_port",a)},expression:"formData.remote_port"}})],1),e("t-form-item",{attrs:{label:"\u5907\u6CE8",name:"remarks"}},[e("t-textarea",{style:{width:"480px"},attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9",name:"remarks"},model:{value:t.textareaValue,callback:function(a){t.textareaValue=a},expression:"textareaValue"}})],1),e("t-form-item",{staticStyle:{float:"right"}},[e("t-button",{attrs:{variant:"outline"},on:{click:t.onClickCloseBtn}},[t._v("\u53D6\u6D88")]),e("t-button",{attrs:{theme:"primary",type:"submit"}},[t._v("\u786E\u5B9A")])],1)],1)],1)]),e("t-dialog",{attrs:{header:"\u7F16\u8F91\u7F51\u7AD9\u9632\u5FA1",visible:t.editFormVisible,width:680,footer:!1},on:{"update:visible":function(a){t.editFormVisible=a}}},[e("div",{attrs:{slot:"body"},slot:"body"},[e("t-form",{ref:"form",attrs:{data:t.formEditData,rules:t.rules,labelWidth:100},on:{submit:t.onSubmitEdit}},[e("t-form-item",{attrs:{label:"\u7F51\u7AD9",name:"host"}},[e("t-input",{style:{width:"480px"},attrs:{placeholder:"\u8BF7\u8F93\u5165\u7F51\u7AD9\u7684\u7F51\u5740"},model:{value:t.formEditData.host,callback:function(a){t.$set(t.formEditData,"host",a)},expression:"formEditData.host"}})],1),e("t-form-item",{attrs:{label:"\u7AEF\u53E3",name:"port"}},[e("t-input-number",{style:{width:"150px"},attrs:{placeholder:"\u8BF7\u8F93\u5165\u7F51\u7AD9\u7684\u7AEF\u53E3\u4E00\u822C\u662F80/443"},model:{value:t.formEditData.port,callback:function(a){t.$set(t.formEditData,"port",a)},expression:"formEditData.port"}})],1),e("t-form-item",{attrs:{label:"\u52A0\u5BC6\u8BC1\u4E66",name:"ssl"}},[e("t-radio-group",{model:{value:t.formEditData.ssl,callback:function(a){t.$set(t.formEditData,"ssl",a)},expression:"formEditData.ssl"}},[e("t-radio",{attrs:{value:"0"}},[t._v("\u975E\u52A0\u5BC6")]),e("t-radio",{attrs:{value:"1"}},[t._v("\u52A0\u5BC6\u8BC1\u4E66\uFF08\u9700\u586B\u5199\u8BC1\u4E66\uFF09")])],1)],1),t.formEditData.ssl=="1"?e("t-form-item",{attrs:{label:"\u8BC1\u4E66\u4E32",name:"certfile"}},[e("t-textarea",{style:{width:"480px"},attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9",name:"certfile"},model:{value:t.formEditData.certfile,callback:function(a){t.$set(t.formEditData,"certfile",a)},expression:"formEditData.certfile"}})],1):t._e(),t.formEditData.ssl=="1"?e("t-form-item",{attrs:{label:"\u5BC6\u94A5\u4E32",name:"keyfile"}},[e("t-textarea",{style:{width:"480px"},attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9",name:"keyfile"},model:{value:t.formEditData.keyfile,callback:function(a){t.$set(t.formEditData,"keyfile",a)},expression:"formEditData.keyfile"}})],1):t._e(),e("t-form-item",{attrs:{label:"\u540E\u7AEF\u7CFB\u7EDF\u7C7B\u578B",name:"remote_system"}},[e("t-select",{style:{width:"480px"},attrs:{clearable:""},model:{value:t.formEditData.remote_system,callback:function(a){t.$set(t.formEditData,"remote_system",a)},expression:"formEditData.remote_system"}},t._l(t.remote_system_options,function(a,l){return e("t-option",{key:l,attrs:{value:a.value,label:a.label}},[t._v(" "+t._s(a.label)+" ")])}),1)],1),e("t-form-item",{attrs:{label:"\u540E\u7AEF\u5E94\u7528\u7C7B\u578B",name:"remote_app"}},[e("t-select",{style:{width:"480px"},attrs:{clearable:""},model:{value:t.formEditData.remote_app,callback:function(a){t.$set(t.formEditData,"remote_app",a)},expression:"formEditData.remote_app"}},t._l(t.remote_app_options,function(a,l){return e("t-option",{key:l,attrs:{value:a.value,label:a.label}},[t._v(" "+t._s(a.label)+" ")])}),1)],1),e("t-form-item",{attrs:{label:"\u540E\u7AEF\u57DF\u540D",name:"remote_host"}},[e("t-input",{style:{width:"480px"},attrs:{placeholder:"\u8BF7\u8F93\u5165\u540E\u7AEF\u57DF\u540D"},model:{value:t.formEditData.remote_host,callback:function(a){t.$set(t.formEditData,"remote_host",a)},expression:"formEditData.remote_host"}})],1),e("t-form-item",{attrs:{label:"\u540E\u7AEF\u7AEF\u53E3",name:"remote_port"}},[e("t-input-number",{style:{width:"150px"},attrs:{placeholder:"\u8BF7\u8F93\u5165\u7F51\u7AD9\u7684\u7AEF\u53E3\u4E00\u822C\u662F80/443"},model:{value:t.formEditData.remote_port,callback:function(a){t.$set(t.formEditData,"remote_port",a)},expression:"formEditData.remote_port"}})],1),e("t-form-item",{attrs:{label:"\u5907\u6CE8",name:"remarks"}},[e("t-textarea",{style:{width:"480px"},attrs:{placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9",name:"remarks"},model:{value:t.textareaValue,callback:function(a){t.textareaValue=a},expression:"textareaValue"}})],1),e("t-form-item",{staticStyle:{float:"right"}},[e("t-button",{attrs:{variant:"outline"},on:{click:t.onClickCloseEditBtn}},[t._v("\u53D6\u6D88")]),e("t-button",{attrs:{theme:"primary",type:"submit"}},[t._v("\u786E\u5B9A")])],1)],1)],1)]),e("t-dialog",{attrs:{header:"\u786E\u8BA4\u5220\u9664\u5F53\u524D\u6240\u9009\u7F51\u7AD9?",body:t.confirmBody,visible:t.confirmVisible,onCancel:t.onCancel},on:{"update:visible":function(a){t.confirmVisible=a},confirm:t.onConfirmDelete}})],1)},E=[];u._withStripped=!0;const d={};var c=p(C,u,E,!1,w,"bcb9afa6",null,null);function w(t){for(let s in d)this[s]=d[s]}c.options.__file="src/pages/waf-host/host/index.vue";var T=function(){return c.exports}();export{T as default};
